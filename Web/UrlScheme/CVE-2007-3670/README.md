# CVE-2007-3670 POC

Simple poc of CVE-2007-3670

这是一个 Firefox 浏览器伪协议的参数注入，影响 Firefox 和 ThunderBird

source : https://www.mozilla.org/en-US/security/advisories/mfsa2007-23/

		 https://bugzilla.mozilla.org/show_bug.cgi?id=384384

Firefox 注册了一个 FirefoxURL: 协议：

```
[HKEY_CLASSES_ROOT\FirefoxURL\shell\open\command\@]
C:\\PROGRA~1\\MOZILL~2\\FIREFOX.EXE -url “%1″ -requestPending
```

使用了引号闭合来注入任意参数

```
FirefoxURL://foo" --argument "my value
```

熟悉的引号闭合，熟悉的参数伪造。Electron 这个漏洞完全就是 10 年前 Firefox 曾经出现过的问题的复刻。

最后通过 -chrome 参数注入的恶意脚本，利用 Firefox 特权域接口，可实现任意代码执行